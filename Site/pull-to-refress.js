(function(b,a){typeof exports=='object'&&typeof module!='undefined'?module.exports=a():typeof define=='function'&&define.amd?define(a):b.PullToRefresh=a()})(this,function(){var m=function(){return'<div class="__PREFIX__box">\n  <div class="__PREFIX__content">\n    <div class="__PREFIX__icon"></div>\n    <div class="__PREFIX__text"></div>\n  </div>\n</div>'},n=function(){return".__PREFIX__ptr {\n  box-shadow: inset 0 -3px 5px  rgba(0, 0, 0, 0.12);\n  pointer-events: none;\n  font-size: 0.85em;\n  font-weight: bold;\n  top: 0;\n  height: 0;\n  transition: height 0.3s, min-height 0.3s;\n  text-align: center;\n  width: 100%;\n  overflow: hidden;\n  display: flex;\n  align-items: flex-end;\n  align-content: stretch;\n}\n.__PREFIX__box {\n  padding: 10px;\n  flex-basis: 100%;\n}\n.__PREFIX__pull {\n  transition: none;\n}\n.__PREFIX__text {\n  margin-top: .33em;\n}\n.__PREFIX__icon {\n  transition: transform .3s;\n}\n.__PREFIX__release .__PREFIX__icon {\n  transform: rotate(180deg);\n}"},a={},j={distThreshold:60,distMax:80,distReload:50,bodyOffset:20,mainElement:'body',triggerElement:'body',ptrElement:'.ptr',classPrefix:'ptr--',cssProp:'min-height',iconArrow:'&#8675;',iconRefreshing:'&hellip;',instructionsPullToRefresh:'Pull down to refresh',instructionsReleaseToRefresh:'Release to refresh',instructionsRefreshing:'Refreshing',refreshTimeout:500,getMarkup:m,getStyles:n,onInit:function(){},onRefresh:function(){return location.reload()},resistanceFunction:function(a){return Math.min(1,a/2.5)}},c=null,f=null,e=0,d=0,b='pending',h=!1,k=!1,l,i;function g(){var d=a.classPrefix,e=a.ptrElement,k=a.iconArrow,g=a.iconRefreshing,h=a.instructionsRefreshing,i=a.instructionsPullToRefresh,j=a.instructionsReleaseToRefresh,f=e.querySelector("."+d+"icon"),c=e.querySelector("."+d+"text");b==='refreshing'?f.innerHTML=g:f.innerHTML=k,b==='releasing'&&(c.innerHTML=j),(b==='pulling'||b==='pending')&&(c.innerHTML=i),b==='refreshing'&&(c.innerHTML=h)}function o(){function h(){var d=a.cssProp,c=a.ptrElement,e=a.classPrefix;c.classList.remove(e+"refresh"),c.style[d]='0px',b='pending'}function i(d){var e=a.triggerElement;if(window.scrollY||(c=d.touches[0].screenY),b!=='pending')return;clearTimeout(l),k=e.contains(d.target),b='pending',g()}function j(h){var i=a.ptrElement,m=a.resistanceFunction,n=a.distMax,j=a.distThreshold,o=a.cssProp,l=a.classPrefix;if(c?f=h.touches[0].screenY:window.scrollY||(c=h.touches[0].screenY),!k||b==='refreshing'){!window.scrollY&&c<f&&h.preventDefault();return}b==='pending'&&(i.classList.add(l+"pull"),b='pulling',g()),c&&f&&(e=f-c),e>0&&(h.preventDefault(),i.style[o]=d+"px",d=m(e/j)*Math.min(n,e),b==='pulling'&&d>j&&(i.classList.add(l+"release"),b='releasing',g()),b==='releasing'&&d<j&&(i.classList.remove(l+"release"),b='pulling',g()))}function m(){var i=a.ptrElement,k=a.onRefresh,n=a.refreshTimeout,o=a.distThreshold,p=a.distReload,m=a.cssProp,j=a.classPrefix;if(b==='releasing'&&d>o)b='refreshing',i.style[m]=p+"px",i.classList.add(j+"refresh"),l=setTimeout(function(){var a=k(h);a&&typeof a.then=='function'&&a.then(function(){return h()}),!a&&!k.length&&h()},n);else{if(b==='refreshing')return;i.style[m]='0px',b='pending'}g(),i.classList.remove(j+"release"),i.classList.remove(j+"pull"),c=f=null,e=d=0}return window.addEventListener('touchend',m),window.addEventListener('touchstart',i),window.addEventListener('touchmove',j,{passive:!1}),{onTouchStart:i,onTouchMove:j,onTouchEnd:m}}function p(){var e=a.mainElement,g=a.getMarkup,h=a.getStyles,d=a.classPrefix,f=a.onInit,b,c;return a.ptrElement||(b=document.createElement('div'),e!==document.body?e.parentNode.insertBefore(b,e):document.body.insertBefore(b,document.body.firstChild),b.classList.add(d+"ptr"),b.innerHTML=g().replace(/__PREFIX__/g,d),a.ptrElement=b),c=document.createElement('style'),c.textContent=h().replace(/__PREFIX__/g,d).replace(/\s+/g,' '),document.head.appendChild(c),typeof f=='function'&&f(a),{styleNode:c,ptrElement:a.ptrElement}}return i={init:function(e){var b,f,c,d;return e===void 0&&(e={}),Object.keys(j).forEach(function(b){a[b]=e[b]||j[b]}),typeof a.mainElement=='string'&&(a.mainElement=document.querySelector(a.mainElement)),typeof a.ptrElement=='string'&&(a.ptrElement=document.querySelector(a.ptrElement)),typeof a.triggerElement=='string'&&(a.triggerElement=document.querySelector(a.triggerElement)),h||(b=o(),h=!0),f=p(),c=f.styleNode,d=f.ptrElement,{destroy:function(){window.removeEventListener('touchstart',b.onTouchStart),window.removeEventListener('touchend',b.onTouchEnd),window.removeEventListener('touchmove',b.onTouchMove),c.parentNode.removeChild(c),d.parentNode.removeChild(d),h=!1,b=null,c=null,d=null,a={}}}}},i})
